#!/usr/bin/env bash

# Simple Activity Duration Watcher
# Uses watchexec to monitor markdown files and process activity durations

VAULT_PATH="${1:-$HOME/Obsidian.nosync/Forge}"
DEBOUNCE_MS="${2:-2000}"

echo "üöÄ Starting Simple Activity Watcher"
echo "üìÅ Vault: $VAULT_PATH"
echo "‚è±Ô∏è Debounce: ${DEBOUNCE_MS}ms"
echo ""
echo "Monitoring for changes to markdown files..."
echo "Press Ctrl+C to stop"
echo ""

# Use watchexec with a simple command
watchexec \
    --watch "$VAULT_PATH" \
    --exts md \
    --debounce "${DEBOUNCE_MS}ms" \
    --on-busy-update restart \
    --notify \
    "activity-duration-processor {}"