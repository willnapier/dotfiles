#!/usr/bin/env bash
# Check semantic search automation status

LOGFILE="$HOME/.local/share/semantic-search/logs/auto-update.log"

echo "ğŸ¤– Semantic Search Automation Status"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"

# Check cron job
echo "ğŸ“… Cron Schedule:"
crontab -l | grep semantic-cron-wrapper | sed 's/^/  /'

echo ""

# Check recent updates
echo "ğŸ“Š Recent Updates:"
if [[ -f "$LOGFILE" ]]; then
    tail -10 "$LOGFILE" | grep -E "(Starting|completed|finished)" | tail -5 | sed 's/^/  /'
else
    echo "  No log file found"
fi

echo ""

# Check if API key is set
if [[ -n "$OPENAI_API_KEY" ]]; then
    echo "âœ… OpenAI API key is configured"
else
    echo "âŒ OpenAI API key not found"
fi

echo ""

# Show next scheduled run
echo "â° Next scheduled runs:"
echo "  Morning: 8:00 AM daily"
echo "  Evening: 8:00 PM daily"