#!/usr/bin/env nu
# dotfiles-setup-hooks - Install git hooks for the dotfiles repo
# Run this after cloning dotfiles or when hooks are updated

def main [] {
    let dotfiles = $env.HOME | path join "dotfiles"
    let hooks_src = $dotfiles | path join "git/hooks"
    let hooks_dest = $dotfiles | path join ".git/hooks"

    if not ($hooks_src | path exists) {
        print "‚ùå No hooks source directory found"
        exit 1
    }

    print "üîß Installing git hooks for dotfiles repo..."

    # Install each hook
    for hook_file in (ls $hooks_src | where type == file) {
        let hook_name = ($hook_file.name | path basename)
        let dest_path = $hooks_dest | path join $hook_name

        # Copy and make executable
        cp $hook_file.name $dest_path
        chmod +x $dest_path

        print $"  ‚úÖ Installed: ($hook_name)"
    }

    print ""
    print "‚úÖ Git hooks installed successfully"
}
