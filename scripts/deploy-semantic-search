#!/bin/bash
# Deploy semantic search system from dotfiles
# This ensures the correct versions are always used

set -e

DOTFILES_DIR="/dotfiles"
SEMANTIC_DIR="/.local/share/semantic-search"

echo "ðŸš€ Deploying semantic search system from dotfiles..."

# Ensure target directory exists
mkdir -p "$SEMANTIC_DIR"
mkdir -p "$SEMANTIC_DIR/db"
mkdir -p "$SEMANTIC_DIR/logs"
mkdir -p "$SEMANTIC_DIR/cache"

# Copy fixed Python scripts
echo "ðŸ“„ Copying Python scripts..."
cp "$DOTFILES_DIR/semantic-search/semantic_indexer.py" "$SEMANTIC_DIR/"
cp "$DOTFILES_DIR/semantic-search/semantic_query.py" "$SEMANTIC_DIR/"
cp "$DOTFILES_DIR/semantic-search/config.yaml" "$SEMANTIC_DIR/"

# Make scripts executable
chmod +x "$SEMANTIC_DIR/semantic_indexer.py"
chmod +x "$SEMANTIC_DIR/semantic_query.py"

echo "âœ… Semantic search system deployed successfully"
echo "ðŸ§ª Fixed version with token truncation is now active"