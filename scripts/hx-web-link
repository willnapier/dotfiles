#!/bin/bash
# Browse all HTML archives under ~/Captures and output wikilink for Helix insertion
CAPTURES=~/Captures

# Find all HTML files (fd handles this fast even with 2000+ files)
selected=$(fd -e html . "$CAPTURES" --type f 2>/dev/null | \
    TERM=xterm-256color sk \
        --prompt "ðŸ“Ž Web archive: " \
        --preview 'bat --color=always --wrap=never --line-range :50 {}' \
        --preview-window "right:60%" \
        --height "80%" \
        --tac)

if [ -n "$selected" ]; then
    # Generate wikilink relative to ~/Captures â†’ captures/
    relpath="${selected#$CAPTURES/}"
    echo "[[captures/$relpath]]"
fi
