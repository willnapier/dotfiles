#!/usr/bin/env nu
# Daily cron job for unified entry collection (projects + activities)
# Runs verbose, logs output

let log_file = $"($env.HOME)/.local/share/collect-entries-cron.log"
let timestamp = (date now | format date "%Y-%m-%d %H:%M:%S")

$"=== ($timestamp) ===\n" | save --append $log_file

try {
    collect-entries --verbose | save --append $log_file
} catch {|err|
    $"ERROR: ($err.msg)\n" | save --append $log_file
}

"\n" | save --append $log_file
